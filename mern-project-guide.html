
    <!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide de Projet MERN</title>
    <style>
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;margin:0;display:flex;color:#333;background-color:#f8f9fa;padding-top:60px}#sidebar{width:280px;position:fixed;height:calc(100% - 60px);background:#fff;border-right:1px solid #ddd;padding:20px;overflow-y:auto;box-shadow:0 0 10px rgba(0,0,0,.05);top:60px}#sidebar h2{margin-top:0;color:#444;border-bottom:2px solid #ffc107;padding-bottom:10px}#sidebar ul{list-style-type:none;padding:0}#sidebar li a{display:block;color:#333;padding:10px 15px;text-decoration:none;border-radius:5px;transition:background-color .2s,color .2s}#sidebar li a:hover{background-color:#e9ecef;color:#0056b3}#main-content{margin-left:320px;padding:20px 40px;width:calc(100% - 320px);padding-top:80px}section{margin-bottom:50px;padding-top:20px}h1,h2,h3{color:#0056b3}h1{border-bottom:1px solid #ccc;padding-bottom:10px}h3{margin-top:30px;border-bottom:1px solid #eee;padding-bottom:5px}code{background-color:#e9ecef;padding:.2em .4em;margin:0;font-size:85%;border-radius:3px;font-family:'Courier New',Courier,monospace}pre{background-color:#2d2d2d;color:#f8f8f2;padding:15px;border-radius:5px;overflow-x:auto}pre code{background-color:transparent;padding:0}.topic-title{font-size:1.2em;font-weight:700;margin-top:20px;margin-bottom:10px;color:#555}.main-nav{width:100%;background-color:#343a40;padding:10px 40px;box-sizing:border-box;position:fixed;top:0;left:0;z-index:1000;display:flex;align-items:center}.main-nav a{color:#fff;text-decoration:none;padding:10px 15px;border-radius:5px;margin-right:10px;font-weight:700}.main-nav a.active{background-color:#ffc107}.main-nav a:hover{background-color:#495057}
    </style>
</head>
<body>

    <nav class="main-nav">
        <a href="index.html">React</a>
        <a href="mongodb.html">MongoDB</a>
        <a href="express.html">Express.js</a>
        <a href="node.html">Node.js</a>
        <a href="redux.html">Redux</a>
        <a href="mern-interactions.html">Interactions</a>
        <a href="mern-project-guide.html" class="active">Project Guide</a>
        <a href="state-transfer.html">Transfert d'État</a>
    </nav>
    
    <nav id="sidebar">
        <h2>Étapes du Projet</h2>
        <div class="topic-title">Plan Directeur</div>
        <ul>
            <li><a href="#project-setup">Mise en Place du Projet</a></li>
            <li><a href="#full-flow">Le Flux de Données Complet</a></li>
        </ul>
        <div class="topic-title">Exemple Simple</div>
        <ul>
            <li><a href="#simple-backend">1. Backend : Créer l'API</a></li>
            <li><a href="#simple-frontend">2. Frontend : Créer le Formulaire</a></li>
        </ul>
        <div class="topic-title">Exemple Complexe</div>
        <ul>
            <li><a href="#complex-backend">3. Backend : API de Lecture</a></li>
            <li><a href="#complex-frontend">4. Frontend : Afficher les Données</a></li>
        </ul>
    </nav>

    <main id="main-content">
        <header>
            <h1>Construire une Application MERN Complète</h1>
        </header>
        
        <section id="project-setup">
            <h2>Plan Directeur : Mise en Place du Projet</h2>
            <p>Un projet MERN typique est structuré avec des dossiers séparés pour le client (React) et le serveur (Node/Express).</p>
            <h4>Structure des dossiers :</h4>
            <pre><code>projet-mern/
├── client/     // Application React
│   ├── public/
│   └── src/
└── serveur/    // Application Node.js & Express
    ├── models/
    ├── routes/
    └── server.js</code></pre>

            <h4>Commandes initiales :</h4>
            <pre><code># 1. Créer le dossier racine
mkdir projet-mern && cd projet-mern

# 2. Mettre en place le serveur
mkdir serveur && cd serveur
npm init -y
npm install express mongoose cors
cd ..

# 3. Mettre en place le client
npx create-react-app client</code></pre>
        </section>

        <section id="full-flow">
            <h2>Plan Directeur : Le Flux de Données Complet</h2>
            <p>Voici le parcours complet des données, du navigateur de l'utilisateur à votre base de données.</p>
            <ol>
                <li><strong>Interaction Utilisateur (React) :</strong> Un utilisateur remplit un formulaire dans votre composant React et clique sur "Envoyer".</li>
                <li><strong>Requête API (React) :</strong> React utilise `fetch` ou `axios` pour envoyer les données du formulaire dans une requête HTTP (ex: POST) à votre serveur backend (ex: `http://localhost:3001/api/users`).</li>
                <li><strong>Gestion de Route (Express) :</strong> Votre serveur Express, à l'écoute des requêtes, fait correspondre l'URL entrante à un gestionnaire de route spécifique que vous avez défini.</li>
                <li><strong>Opération sur la Base de Données (Node/Mongoose) :</strong> La logique du gestionnaire de route utilise un modèle Mongoose pour valider et formater les données. Il demande ensuite à MongoDB de sauvegarder ces données comme un nouveau document.</li>
                <li><strong>Exécution par la Base de Données (MongoDB) :</strong> MongoDB enregistre les données et confirme que l'opération a réussi.</li>
                <li><strong>Réponse de l'API (Express) :</strong> Le serveur Express envoie une réponse de succès (ex: statut 201 avec l'utilisateur nouvellement créé) à votre application React.</li>
                <li><strong>Mise à Jour de l'UI (React) :</strong> Votre application React reçoit la réponse et peut mettre à jour l'interface utilisateur en conséquence (ex: vider le formulaire, afficher un message de succès).</li>
            </ol>
        </section>

        <section id="simple-backend">
            <h2>Exemple Simple 1 : API Backend pour Créer un Utilisateur</h2>
            <p>D'abord, nous construisons le point d'accès côté serveur qui recevra et enregistrera les données.</p>
            
            <h4>Définir un Modèle (`serveur/models/User.js`)</h4>
            <pre><code>const mongoose = require('mongoose');
const userSchema = new mongoose.Schema({
  name: { type: String, required: true },
  email: { type: String, required: true, unique: true },
});
module.exports = mongoose.model('User', userSchema);</code></pre>
            
            <h4>Créer la Route API (`serveur/routes/users.js`)</h4>
            <pre><code>const express = require('express');
const router = express.Router();
const User = require('../models/User');

// POST /api/users - Créer un nouvel utilisateur
router.post('/', async (req, res) => {
  try {
    const newUser = new User({
      name: req.body.name,
      email: req.body.email,
    });
    const savedUser = await newUser.save();
    res.status(201).json(savedUser);
  } catch (err) {
    res.status(400).json({ message: 'Erreur lors de la création de l\'utilisateur' });
  }
});

module.exports = router;</code></pre>
            
            <h4>Configurer le fichier serveur principal (`serveur/server.js`)</h4>
            <pre><code>const express = require('express');
const mongoose = require('mongoose');
const cors = require('cors');

const app = express();
const PORT = 3001;
const usersRoutes = require('./routes/users');

// Middleware
app.use(cors()); // Autorise les requêtes cross-origin depuis votre app React
app.use(express.json()); // Analyse les requêtes JSON entrantes

// Connexion à MongoDB
mongoose.connect('mongodb://localhost/mern_db');

// Routes
app.use('/api/users', usersRoutes);

app.listen(PORT, () => console.log(`Serveur démarré sur le port ${PORT}`));</code></pre>
        </section>

        <section id="simple-frontend">
            <h2>Exemple Simple 2 : Formulaire Frontend pour Envoyer des Données</h2>
            <p>Maintenant, nous construisons le composant React qui envoie les données à l'API backend.</p>

            <h4>Composant React (`client/src/components/UserForm.js`)</h4>
            <pre><code>import React, { useState } from 'react';

function UserForm() {
  const [name, setName] = useState('');
  const [email, setEmail] = useState('');

  const handleSubmit = async (event) => {
    event.preventDefault();
    const userData = { name, email };

    try {
      const response = await fetch('http://localhost:3001/api/users', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(userData),
      });

      if (response.ok) {
        alert('Utilisateur créé avec succès !');
        setName(''); // Vider le formulaire
        setEmail('');
      } else {
        alert('Échec de la création de l\'utilisateur.');
      }
    } catch (error) {
      console.error('Erreur:', error);
    }
  };

  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;input type="text" value={name} onChange={e => setName(e.target.value)} placeholder="Nom" required /&gt;
      &lt;input type="email" value={email} onChange={e => setEmail(e.target.value)} placeholder="Email" required /&gt;
      &lt;button type="submit"&gt;Créer Utilisateur&lt;/button&gt;
    &lt;/form&gt;
  );
}

export default UserForm;</code></pre>
        </section>

        <section id="complex-backend">
            <h2>Exemple Complexe 3 : API Backend pour Lire Tous les Utilisateurs</h2>
            <p>Pour rendre notre application plus utile, créons un point d'accès pour récupérer tous les utilisateurs que nous avons créés.</p>
            
            <h4>Ajouter une Route GET (`serveur/routes/users.js` - mis à jour)</h4>
            <pre><code>// ... (code de la route POST existante) ...

// GET /api/users - Obtenir tous les utilisateurs
router.get('/', async (req, res) => {
  try {
    const users = await User.find();
    res.json(users);
  } catch (err) {
    res.status(500).json({ message: 'Erreur serveur' });
  }
});

module.exports = router;</code></pre>
        </section>

        <section id="complex-frontend">
            <h2>Exemple Complexe 4 : Composant Frontend pour Afficher les Données</h2>
            <p>Ce composant utilise le hook `useEffect` pour récupérer les données au premier chargement et `useState` pour stocker la liste des utilisateurs et un état de chargement.</p>
            
            <h4>Composant React (`client/src/components/UserList.js`)</h4>
            <pre><code>import React, { useState, useEffect } from 'react';

function UserList() {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);

  // useEffect s'exécute une fois lorsque le composant est monté
  useEffect(() => {
    const fetchUsers = async () => {
      try {
        const response = await fetch('http://localhost:3001/api/users');
        const data = await response.json();
        setUsers(data); // Stocker les utilisateurs récupérés dans l'état
      } catch (error) {
        console.error('Erreur lors de la récupération des utilisateurs:', error);
      } finally {
        setLoading(false); // Arrêter le chargement, qu'il y ait succès ou erreur
      }
    };

    fetchUsers();
  }, []); // Le tableau de dépendances vide [] garantit que cela ne s'exécute qu'une fois

  if (loading) {
    return &lt;p&gt;Chargement des utilisateurs...&lt;/p&gt;;
  }

  return (
    &lt;div&gt;
      &lt;h2&gt;Liste des Utilisateurs&lt;/h2&gt;
      &lt;ul&gt;
        {users.map(user => (
          &lt;li key={user._id}&gt;{user.name} ({user.email})&lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}

export default UserList;</code></pre>
        </section>

    </main>

</body>
</html>
